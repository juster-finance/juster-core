### Ликвидные ставки

Смарт контракт на PascaLIGO позволяющий делать ставки на изменение цены в определённом интервале времени, базирующийся на ответах от оракула.

Изначально это решение в рамках челленджа #10 на хакатоне по децентрализованным финансам (26-28 февраля 2021 года).

Два варианта событий:
- Событие завершилось в соответствии с описанием (положительно): S
- Событие завершилось противоположно описанию (отрицательно): ~S

Исходное описание алгоритма (по результатам обсуждения):
- Создатель при создании смарт контракта обеспечивает ликвидностью оба пула (для S, ~S)
- Любой участник сети (включая создателя) может вложить токены в S / ~S
- Любой участник сети (включая создателя) может вложить ликвидность в оба пула (S, ~S)
- В случае добавления ликвидности (создателем или другим участником), он участвует в финальном распределению бонуса за ликвидность
- Создатель при создании контракта определяет размер бонуса за ликвидность (L, % от итогового пула со ставками)
- При создании контракта определяется момент отсечения ставок (с какого момента нельзя вносить ставки в контракт)
- При создании контракта определяется длительность периода измерения и результат измерения: это два чекпоинта (Ts - начало периода start, Te - конец периода end). Пример результата: цена тезоса за период выросла на 100 долларов или цена эфира упала на 10%.
- При создании контракта создатель закладывает вознаграждение за экспирацию (процент или сумма) Ex, также закладывается вознаграждение за вызов измерения исходной цены (в момент начала периода измерения)
- Каждое внесение ликвидности корректируется на коэффициент полезности средств, в зависимости от текущего момента времени: при Ts == 1, при Te == 0. Линейное изменение. Внесенная ликвидность с коэффициентом ликвидности записывается в big map для каждого кто вносит ликвидность: l1, l2, ..., ln. Параллельно считается суммарная внесённая ликвидность по всем участникам (для того чтобы потом не итерироваться по бигмапу)
- При внесении средств в ликвидность можно использовать три варианта:
    - оценивать текущее отношение по рынку и вносить по нему. В этом случае нужно обязательно проверять что ожидаемое соотношение пользователя соответствует тому что сейчас на рынке (для исключения возможности изменить это соотношение когда кто-то вносит ликвидность добавив транзакцию с большей комиссией, которая делает какую-то ставку. Хотя такое действие возможно само по себе невыгодно, нужно подумать на сколько это может быть проблемой, смоделировать варианты)
    - вносить ликвидность в той же пропорции что и создатель
    - дать возможность вносить ликвидность в любой пропорции. Но тогда нужно оценивать внесённую ликвидность по его минимальному пулу. Этот вариант выбран для реализации, так как он позволяет объединить роли better-а и того кто представляет ликвидность и свести все эти роли к использованию одного entrypoint: bet

- Экспирация/исходное измерение может быть вызвано любым участником после Te, он получает сумму Ex
- При экспирации из итогового пула исключается Ex, L (%), остающиеся распределяются среди победителей. Пул L распределяется среди тех кто предоставил ликвидность пропорционально lk

### Дальнейшие планы:
1. Сделать фронтэнд с платформой для работы с контрактом:
    - Страница со списком существующих событий, сортировка по дате исполнения, валютам
    - Визуализация по каждому событию: какой процент заложен в какой части контракта (на достижение / не достижение границы по контракту)
    - Каждое событие кликабельное, хочется, чтобы открывалось окно с возможностью сделать ставку за и против
    - Кнопка для создания нового события
    - ...

2. Необходимо покрыть имеющийся код смарт контракта тестами.
    - Нужно сделать динамические тесты
    - Текущий большой тест лучше перенести в sandbox

3. Необходимо понять, можно ли каким-то образом привязать токен к системе? Можно платить токеном за экспирацию, за ставки, за предоставление ликвидности, за победу. Основной вопрос в чём будет ценность токена, для чего его можно будет использовать? Может быть для создания событий нужно платить токеном?

4. Сделать деплой контракта и платформы в мейннете

